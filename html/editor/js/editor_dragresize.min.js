function DextDragResize(){var a={resizeName:"DEXT_fiVe_drag_resize",handles:"tl tm tr ml mr bl bm br".split(" "),handle:null,minWidth:0,minHeight:0,minLeft:-99999,maxLeft:99999,minTop:-99999,maxTop:99999,mouseX:0,mouseY:0,lastMouseX:0,lastMouseY:0,iframeDocLastMouseX:0,iframeDocLastMouseY:0,topMouseX:null,topMouseY:null,docMouseX:null,docMouseY:null,docLastMouseX:0,docLastMouseY:0,mOffX:0,mOffY:0,elmX:0,elmY:0,elmW:0,elmH:0,dextResizeIconInterval:null,G_REMOVE_dextResizeIcon:!0,G_dextResize_elem:null,
G_dextResize_OverElem:null,G_dextResize_showContext:!0,G_dextResizeIcon:null,G_editIconTagName:",table,div,",G_dextResizeEditIcon:null,G_dextResizeEditElem:null,G_dextResizeDiv:null,G_dextResizeHandleHolder:null,G_dextResizeDivBorder:1,G_dextResizeIconSrc1:"data:image/gif;base64,R0lGODdhDQANAHcAACwAAAAADQANAIcAAACAAAAAgACAgAAAAICAAIAAgIDAwMDA3MCmyvD/+/CgoKSAgID/AAAA/wD//wAAAP//AP8A//////9NT1Cbm5v///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABOteJOteoY8WhOtfQAAAAAAAAoD3oAAABxj6AY8NRFEvoAAAr///8AAAAAAAAY8QA/YvoBAsIAAAr///8AAAAoD3q6q80AAAAAAAAoD3oY8RAY8SxGAjBxj6AY8Xg/bZE/bVFKAQ8AAAoY8Tig8JwAATgAAB8Y8UAY8VSg8QcAAVcY8VidWk8AAggAAACdYQedYMIBLZYFIRwAAAAAAA0uAADV6mAAAAAAAggAAAAY8aidayidbCkFLKQAAFQY8qQY8bCdbJIFLKQAAFQY8qQY8uQY8nxG/UAFLKQAAFQY8qRAaYZG+i0Y8oxG/UEY8nwFIRwAAADLeDgAAAABAAAAIRyiATCiAaCiATAY8hSdWEeiAaABAAAAIRwFAACdV1idV9MFIRxAYtVAXWyqAVBAQ65AXKkY8gFAYm1G9ZcY8viqAVCqALwFLKQY8vgY8nhHEonl4SBHEpEFIRwAAADLeDiqAFDLeDgY8wBHAg4AAAAAAAAY8qQY8wxHAhgY8wAY8z+qAYAAAAEAAAAAAA0AAA0AACgYAAEuAAAAACgAAA0AAA0YAAEAAAAAAggAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFLKQY84RHHWIY8ycAAAFHAn1HHZ5xj6DG5SgAAAEAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAGAAIPAArCBxIkOCEgwgTThCokIJChggpSEwIMeLDCgcdTtCokaHEjyAXYtyYsaTIhhcTfqQ40iJLhTALyhwYEAA7",
G_dextResizeBackSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAbCAYAAACJISRoAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MjYxNUNGOTEwQUM4MTFFNzk5RDI5MEMzQ0Y5RkRFRTUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MjYxNUNGOTIwQUM4MTFFNzk5RDI5MEMzQ0Y5RkRFRTUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoyNjE1Q0Y4RjBBQzgxMUU3OTlEMjkwQzNDRjlGREVFNSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoyNjE1Q0Y5MDBBQzgxMUU3OTlEMjkwQzNDRjlGREVFNSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Ptsh5hAAAAHHSURBVHja3JZPSwJBGMbXP9QnCMkg+gweyg+wJtK5iC51jqRrgZ7s0L1zYJeIiKJDiOg9DeoqiiEdXLwqKq62O/ksvbLZDDvTv0MD4+zM7MyPd55n3tXHGNN+u/i1PyhKkPLDUzQW3yigVaLguGRqqfwY1VfXC02jxdCiL7tWGYCiClIGUFEBeUJ4gGmQ1x5Swi8uRezg7II9Fr2IPlr0MS6zPuj1QiF/GaNnOIueX81m4MsWJpu6N5QptIZrb5HIgZmwxdMHWvB0wPuNxgvXDEIXiSC2bQsh/X6f1Z8bn0A+/CDEVPo4c5Y90cPzIQq/yDuWfO5Cjyc2uXO3N1kd+xlGS9vdOyweZQ7SK8uRkqdNqSACy7KcOhqN2HA4ZKZpssFgwBBBr9dj3W6XdTod1m63WaVSnUTsuAvE7Z2kJhNJ7u5cT6xtceeur04nkST3U04kH4SX1QQRiDRxR+DWRNldOCIRhAfgphUC8TbCGDQQzYlymXSqp40gsky+UspduMXjPGWhkoZOPnofk8kMQZmUUa/e+0OhOQAc90y56PtfRtIIN5l3D37ke+IG1Wp1ZYCS8ARSBSi7i0AqgEmC/Bd/7t4EGABOzb4ZtI2OfAAAAABJRU5ErkJggg==",
G_dextResizeEditIconSrc:"data:image/png;base64,R0lGODlhDwAPAMQAAPzqrG5ubmJiYlBPTMrKyv7s1fzINf7aVO7u7qysrE5NS+kwL/+rsu/v70hGQe6xDtpDVD09PREAAFFRUURERP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4zLWMwMTEgNjYuMTQ1NjYxLCAyMDEyLzAyLzA2LTE0OjU2OjI3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBQUIwMDJGNTEwNUMxMUU3QTQ1RDg2M0VCRDhDNDFCNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBQUIwMDJGNjEwNUMxMUU3QTQ1RDg2M0VCRDhDNDFCNSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkFBQjAwMkYzMTA1QzExRTdBNDVEODYzRUJEOEM0MUI1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkFBQjAwMkY0MTA1QzExRTdBNDVEODYzRUJEOEM0MUI1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAAAAAAAsAAAAAA8ADwAABVVgoFBkaZIiUa1sK0lkK1cSA8EzOxXSguc7AEDioAABh8OkEos4K40JwGBYMo0VwSpRmTys15W2i0CAw9mVZMJtxdK5VfMZf8dZlIHqXiEMAgMngn8hADs=",
G_dextResizeBackDiv:null,G_isResize:!1,G_isDrag:!1,G_firstDrag:!1,G_checkTagName:",img,iframe,td,th,table,embed,div,",G_mouseOveriframeObj:null,G_dextIframeOverDiv:null,G_startX:0,G_startY:0,G_dragX:0,G_dragY:0,G_lastDragX:0,G_lastDragY:0,G_orgEnterTag:"",G_ie8Bug:!1,keyDownEvt:null,G_dextResize_elem_Rect:null,G_UseMouseTableInoutdent:!1,G_ImageR:1},b;for(b in a)this[b]=a[b]}
DextDragResize.prototype.selection=function(a){try{if(a){var b=getFirstRange(),c=b.range;b.sel.removeAllRanges();c.selectNode(a);b.sel.addRange(c);(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)&&a.tagName&&"TABLE"==a.tagName&&(DEXTTOP.G_COPIEDTABLE=a,command_tableCopy(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,!0))}}catch(d){}};
DextDragResize.prototype.apply=function(a){try{var b=this;b.mouseDownEvt=function(a){try{b.mouseDown(a)}catch(c){}};b.mouseMoveTopEvt=function(a){try{b.elementResize(a,"top")}catch(c){}};b.mouseUpEvt=function(a){try{b.mouseUp(a)}catch(c){}};b.mouseOverEvt=function(a){try{b.mouseOver(a)}catch(c){}};b.keyDownEvt=function(a){try{b.keyDown(a)}catch(c){}};b.dragEndEvt=function(a){try{b.dragEnd(a)}catch(c){}};DEXTTOP.DEXT5.util.addEvent(a,"mouseover",b.mouseOverEvt,!0);DEXTTOP.DEXT5.util.addEvent(a,"mousedown",
b.mouseDownEvt,!0);DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTDOC,"mousemove",b.mouseMoveTopEvt,!0);DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTDOC,"mouseup",b.mouseUpEvt,!0);DEXTTOP.DEXT5.util.addEvent(document,"mouseup",b.mouseUpEvt,!0);DEXTTOP.DEXT5.util.addEvent(a,"mouseup",b.mouseUpEvt,!0);DEXTTOP.DEXT5.util.addEvent(a,"dragend",b.dragEndEvt,!0)}catch(c){}};
DextDragResize.prototype.remove=function(a){try{DEXTTOP.DEXT5.util.removeEvent(a,"mouseover",this.mouseOverEvt,!0),DEXTTOP.DEXT5.util.removeEvent(a,"mousedown",this.mouseDownEvt,!0),DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTDOC,"mousemove",this.mouseMoveTopEvt,!0),DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTDOC,"mouseup",this.mouseUpEvt,!0),DEXTTOP.DEXT5.util.removeEvent(document,"mouseup",this.mouseUpEvt,!0),DEXTTOP.DEXT5.util.removeEvent(a,"mouseup",this.mouseUpEvt,!0),DEXTTOP.DEXT5.util.removeEvent(a,
"dragend",this.dragEndEvt,!0)}catch(b){}};DextDragResize.prototype.dragEnd=function(a){with(this)"1"!=DEXTTOP.G_CURREDITOR._config.dragResizeMovable&&G_dextResize_elem&&"absolute"!=G_dextResize_elem.style.position.toLowerCase()&&(selection(G_dextResize_elem),resizeHandleClear())};
DextDragResize.prototype.mouseDown=function(a){if(!DEXTTOP.G_CURREDITOR._FRAMEWIN.isViewMode(DEXTTOP.G_CURREDITOR)){var b=a?a:_iframeWin.event;if(0!=checkContentEditable(DEXTTOP.G_CURREDITOR,b.target?b.target:b.srcElement))with(this)try{var c=a.target||a.srcElement;if(isRightClick(a)){G_dextResize_elem&&(c=G_dextResize_elem);this.resizeHandleClear();"img"==c.tagName.toLowerCase()&&selection(c);return}G_ie8Bug=!1;if(G_dextResizeEditElem){if(G_dextResizeEditElem==c)return;var d=GetParentbyTagName(c,
"div");if(d&&G_dextResizeEditElem==d)return;DEXTTOP.G_CURREDITOR._config.enterTag=G_orgEnterTag;G_dextResizeEditElem=null}if(0>",table,td,th,".indexOf(","+c.tagName.toLowerCase()+",")&&-1<G_checkTagName.indexOf(","+c.tagName.toLowerCase()+",")&&G_dextResizeIcon!=c&&c!=G_dextResizeDiv){G_UseMouseTableInoutdent=!1;if("div"==c.tagName.toLowerCase()){if(-1<c.className.indexOf("DEXT_fiVe_Page_Break"))return;if(""!=DEXTTOP.G_CURREDITOR._config.dragResizeApplyDivClass&&0>(","+DEXTTOP.G_CURREDITOR._config.dragResizeApplyDivClass+
",").indexOf(","+c.className+",")){resizeHandleClear();return}}b=!1;G_dextResize_elem&&G_dextResize_elem!=c&&(c.tagName.toLowerCase()==G_dextResize_elem.tagName.toLowerCase()||"div"==c.tagName.toLowerCase()&&"iframe"==G_dextResize_elem.tagName.toLowerCase())&&(b=!0);resizeHandleClear();G_dextResize_elem=c;clearInterval(dextResizeIconInterval);setResizeHandle(a,!0,"doc");b&&(G_ie8Bug=!0);"1"==DEXTTOP.G_CURREDITOR._config.dragResizeMovable||"absolute"==G_dextResize_elem.style.position.toLowerCase()||
"div"==c.tagName.toLowerCase()?DEXTTOP.DEXT5.util.cancelEvent(a):selection(c)}else G_dextResizeIcon!=c&&c!=G_dextResizeDiv&&(GetParentbyTagName(c,"div"),resizeHandleClear())}catch(e){}}};
DextDragResize.prototype.mouseOver=function(a){var b=getEditrFromEvent(a);if(!b._FRAMEWIN.isViewMode(b)){var c=a?a:_iframeWin.event,d=c.target?c.target:c.srcElement;if(0==checkContentEditable(b,d))DEXTTOP.DEXT5.util.cancelEvent(a);else with(b.dext_dragresize)try{b=getEditrFromEvent(a);if(isViewMode(b))return;var d=null,c=a?a:_iframeWin.event,d=c.target?c.target:c.srcElement,e=d.tagName?d.tagName.toLowerCase():null;if(null==d||null==e||(new RegExp(resizeName+"-([trmbl]{2})","")).test(d.className)||
"DEXT_fiVe_drag_resizeinfo"==d.className||d==G_dextResizeBackDiv||d==G_dextResizeIcon||d==G_dextResizeDiv||d==G_dextIframeOverDiv)return;if(-1<G_checkTagName.indexOf(","+e+",")){if("div"==e){if(-1<d.className.indexOf("DEXT_fiVe_Page_Break"))return;if(""!=b._config.dragResizeApplyDivClass){var f=","+b._config.dragResizeApplyDivClass+",";if(0>f.indexOf(","+d.className+","))return}}"iframe"==e?(G_mouseOveriframeObj=d,setIfameOverDiv(a)):clearIfameOverDiv();G_REMOVE_dextResizeIcon=!1;var g;g="td"==e||
"th"==e?GetParentbyTagName(d,"table"):d;if("table"==g.tagName.toLowerCase()&&checkNoResizeTable(g)||G_dextResize_elem==g||G_dextResize_OverElem==g)return;G_dextResize_OverElem=g;if("div"==G_dextResize_OverElem.tagName.toLowerCase()&&"div"==_iframeDoc.activeElement.tagName.toLowerCase())return;DEXTTOP.G_CURREDITOR=b;setResizeIcon();DEXTTOP.DEXT5.util.addEvent(G_dextResize_OverElem,"mouseout",ResizeElmOutEvt)}else{var m=GetParentbyTagName(d,"table"),h=GetParentbyTagName(d,"div");if(m||h){m&&h?G_dextResize_OverElem=
GetParentbyTagName(h,"table")?h:m:m?G_dextResize_OverElem=m:h&&(G_dextResize_OverElem=h);if("div"==G_dextResize_OverElem.tagName.toLowerCase()&&"div"==_iframeDoc.activeElement.tagName.toLowerCase())return;if("table"==G_dextResize_OverElem.tagName.toLowerCase()&&checkNoResizeTable(G_dextResize_OverElem)){G_dextResize_OverElem=null;return}if("div"==G_dextResize_OverElem.tagName.toLowerCase()&&(-1<G_dextResize_OverElem.className.indexOf("DEXT_fiVe_Page_Break")||""!=b._config.dragResizeApplyDivClass&&
(f=","+b._config.dragResizeApplyDivClass+",",0>f.indexOf(","+G_dextResize_OverElem.className+","))))return;DEXTTOP.G_CURREDITOR=b;setResizeIcon();DEXTTOP.DEXT5.util.addEvent(G_dextResize_OverElem,"mouseout",ResizeElmOutEvt)}}}catch(l){}}};
DextDragResize.prototype.checkNoResizeTable=function(a){var b=DEXTTOP.G_CURREDITOR._config.tableNoResizeClass;if(""!=b&&a.className&&""!=a.className)for(var c=a.className.split(" "),d=c.length,e=!1,f=0;f<d;f++)if(c[f]==b){e=!0;break}e||"1"==DEXTTOP.G_CURREDITOR._config.formMode||"1"!=DEXTTOP.G_CURREDITOR._config.userTableLock.use||(e=checkLockAttr(a));return e};
DextDragResize.prototype.setResizeIcon=function(){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{if(null==G_dextResizeIcon&&(dextResizeIcon=_iframeDoc.createElement("img"),dextResizeIcon.id="dextResizeIcon",dextResizeIcon.src=G_dextResizeIconSrc1,dextResizeIcon.style.position="absolute",dextResizeIcon.style.zIndex=1E3,dextResizeIcon.style.cursor="move",dextResizeIcon.unSelectable="on",dextResizeIcon.alt="",G_dextResizeIcon=dextResizeIcon,getEditorFrameDoc(DEXTTOP.G_CURREDITOR).body.appendChild(G_dextResizeIcon),
DEXTTOP.DEXT5.util.addEvent(G_dextResizeIcon,"mouseover",function(){G_REMOVE_dextResizeIcon=!1}),DEXTTOP.DEXT5.util.addEvent(G_dextResizeIcon,"mouseout",function(){G_REMOVE_dextResizeIcon=!0}),DEXTTOP.DEXT5.util.addEvent(G_dextResizeIcon,"mousedown",function(b){G_REMOVE_dextResizeIcon=!1;var a=G_dextResize_OverElem;DEXTTOP.G_CURREDITOR._config.useMouseTableInoutdent&&(G_dextResize_elem_Rect=getClientRect(a),G_UseMouseTableInoutdent="TABLE"==a.nodeName?!0:!1);resizeHandleClear();G_dextResize_elem=
a;clearInterval(dextResizeIconInterval);setResizeHandle(b,!0);G_CURSOR_ELEMENT=a;"img"==a.nodeName.toLowerCase()&&(G_dextResize_Elem_Flag=!0)})),G_dextResizeIcon){G_REMOVE_dextResizeIcon=!1;var a=getElementOffset(_iframeWin.frameElement),b=getClientRect(G_dextResize_OverElem);G_dextResizeIcon.style.left=a.left+b.left+"px";G_dextResizeIcon.style.top=a.top+(b.top-13)+"px"}}catch(c){}};
DextDragResize.prototype.setIfameOverDiv=function(a){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{G_dextIframeOverDiv&&(clearIfameOverDiv(),G_dextIframeOverDiv=null);var b;b=_iframeDoc.createElement("div");b.id="dextIframeOverDiv";b.contentEditable="false";b.style.position="absolute";b.style.cursor="move";DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion?(b.style.filter="alpha(opacity=1)",b.style.background="white"):DEXTTOP.DEXT5.browser.ie&&(b.style.opacity="0.1",b.style.background="white");
b.style.zIndex=G_mouseOveriframeObj.style.zIndex;var c=getElementOffset(_iframeWin.frameElement),d=getClientRect(G_mouseOveriframeObj);b.style.left=c.left+d.left+"px";b.style.top=c.top+d.top+"px";b.style.width=d.right-d.left+"px";b.style.height=d.bottom-d.top+"px";G_dextIframeOverDiv=b;getEditorFrameDoc(DEXTTOP.G_CURREDITOR).body.appendChild(G_dextIframeOverDiv);DEXTTOP.DEXT5.util.addEvent(G_dextIframeOverDiv,"mousedown",ifameOverDivClick)}catch(e){}};
DextDragResize.prototype.ifameOverDivClick=function(a){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{var b=G_mouseOveriframeObj;resizeHandleClear();G_dextResize_OverElem=null;G_dextResize_elem=b;clearInterval(dextResizeIconInterval);setResizeHandle(a,!0)}catch(c){}};
DextDragResize.prototype.setHandlePosition=function(){with(DEXTTOP.G_CURREDITOR.dext_dragresize)for(var a=getElementOffset(_iframeWin.frameElement),b=getClientRect(G_dextResize_elem),c=0,d=0,e=0;e<handles.length;e++){switch(handles[e]){case "tl":c=a.left+b.left-7;d=a.top+b.top-7;break;case "tm":c=a.left+b.left+.5*(b.right-b.left);d=a.top+b.top-7;break;case "tr":c=a.left+b.left+(b.right-b.left);d=a.top+b.top-7;break;case "ml":c=a.left+b.left-7;d=a.top+b.top+.5*(b.bottom-b.top);break;case "mr":c=a.left+
b.left+(b.right-b.left);d=a.top+b.top+.5*(b.bottom-b.top);break;case "bl":c=a.left+b.left-7;d=a.top+b.top+(b.bottom-b.top);break;case "bm":c=a.left+b.left+.5*(b.right-b.left);d=a.top+b.top+(b.bottom-b.top);break;case "br":c=a.left+b.left+(b.right-b.left),d=a.top+b.top+(b.bottom-b.top)}G_dextResizeHandleHolder[handles[e]].style.left=c+"px";G_dextResizeHandleHolder[handles[e]].style.top=d+"px"}};
DextDragResize.prototype.setResizeHandle=function(a,b,c){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{if(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv)e=getElementOffset(_iframeWin.frameElement),f=getClientRect(G_dextResize_elem),G_UseMouseTableInoutdent&&0>parseInt(G_dextResize_elem.style.marginLeft)||(G_dextResizeDiv.style.left=e.left+f.left-G_dextResizeDivBorder+"px"),G_dextResizeDiv.style.top=G_UseMouseTableInoutdent?e.top+G_dextResize_elem_Rect.top-G_dextResizeDivBorder+"px":e.top+f.top-
G_dextResizeDivBorder+"px",G_dextResizeDiv.style.width=f.right-f.left+"px",G_dextResizeDiv.style.height=f.bottom-f.top+"px";else{ClearDraggingTableCellSelected();var d;d=_iframeDoc.createElement("div");d.className="DEXT_fiVe_drag_resize_Element DEXT_fiVe_drag_move_Handle";d.id="dextResizeDiv";d.contentEditable="false";if("1"==DEXTTOP.G_CURREDITOR._config.dragResizeMovable||G_UseMouseTableInoutdent)d.style.background="url("+G_dextResizeBackSrc+") no-repeat 50% 50%";d.style.position="absolute";d.style.border=
G_dextResizeDivBorder+"px solid transparent";d.style.cursor="move";d.style.zIndex=999999;"div"!=G_dextResize_elem.tagName.toLowerCase()&&"absolute"!=G_dextResize_elem.style.position&&"1"!=DEXTTOP.G_CURREDITOR._config.dragResizeMovable&&(d.style.display="none",G_UseMouseTableInoutdent&&(d.style.display=""));var e=getElementOffset(_iframeWin.frameElement),f=getClientRect(G_dextResize_elem);G_UseMouseTableInoutdent&&0>parseInt(G_dextResize_elem.style.marginLeft)||(d.style.left=e.left+f.left-G_dextResizeDivBorder+
"px");d.style.top=G_UseMouseTableInoutdent?e.top+G_dextResize_elem_Rect.top-G_dextResizeDivBorder+"px":e.top+f.top-G_dextResizeDivBorder+"px";d.style.width=f.right-f.left+"px";d.style.height=f.bottom-f.top+"px";G_dextResizeHandleHolder=_iframeDoc.createElement("div");G_dextResizeHandleHolder.unSelectable="on";for(e=0;e<handles.length;e++){var g=document.createElement("div");g.className=resizeName+" "+resizeName+"-"+handles[e];g.unSelectable="on";G_dextResizeHandleHolder.appendChild(g);G_dextResizeHandleHolder[handles[e]]=
g}setHandlePosition();var m=getEditorFrameDoc(DEXTTOP.G_CURREDITOR);0==("0"==DEXTTOP.G_CURREDITOR._config.tableUseHeight&&"TABLE"==G_dextResize_elem.tagName)&&m.body.appendChild(G_dextResizeHandleHolder);g=document.createElement("div");g.className="DEXT_fiVe_drag_resizeinfo";g.style.position="absolute";g.style.fontSize="11px";g.style.display="none";g.unSelectable=!0;var h=document.createElement("span");g.appendChild(h);G_dextResizeHandleHolder.appendChild(g);G_dextResizeHandleHolder.dext_resizeinfo=
g;G_dextResizeEditElem&&(DEXTTOP.G_CURREDITOR._config.enterTag=G_orgEnterTag,G_dextResizeEditElem=null);if(G_dextResize_elem.isContentEditable&&-1<G_editIconTagName.indexOf(","+G_dextResize_elem.tagName.toLowerCase()+",")){var l=_iframeDoc.createElement("img");l.id="dextResizeEditIcon";l.src=G_dextResizeEditIconSrc;l.style.zIndex=99999999;l.style.position="absolute";l.style.cursor="pointer";l.style.right="0px";l.style.top="0px";d.appendChild(l);G_dextResizeEditIcon=l}m=getEditorFrameDoc(DEXTTOP.G_CURREDITOR);
m.body.appendChild(d);G_dextResizeDiv=d;d="dextResize";var n=G_dextResize_elem.tagName.toLowerCase();if("img"==n){var p,k;if(-1<G_dextResize_elem.style.width.indexOf("%")||-1<G_dextResize_elem.style.height.indexOf("%")){var q=getClientRect(G_dextResize_elem);p=q.right-q.left;k=q.bottom-q.top}else""!=G_dextResize_elem.style.width?p=DEXTTOP.DEXT5.util.parseIntOr0(G_dextResize_elem.style.width):(q=getClientRect(G_dextResize_elem),p=q.right-q.left),""!=G_dextResize_elem.style.height?k=DEXTTOP.DEXT5.util.parseIntOr0(G_dextResize_elem.style.height):
(q=getClientRect(G_dextResize_elem),k=q.bottom-q.top);G_ImageR=1*p/k;DEXTTOP.G_SELECTED_IMAGE_ELEMENT=G_dextResize_elem;d=GetParentbyTagName(G_dextResize_elem,"figure")?"focusFigure":"focusImage"}else"table"==n&&(d="focusTable");DEXTTOP.G_CURREDITOR._iconEnable(d);DEXTTOP.DEXT5.util.removeEvent(G_dextResizeDiv,"keydown",keyDown);DEXTTOP.DEXT5.util.addEvent(G_dextResizeDiv,"mousedown",startDragElem);DEXTTOP.DEXT5.util.addEvent(G_dextResizeHandleHolder,"mousedown",startDragElem)}b&&startDragElem(a,
c)}catch(r){}};
DextDragResize.prototype.ResizeElmOutEvt=function(a){a=getEditrFromEvent(a);with(a.dext_dragresize)try{G_REMOVE_dextResizeIcon=!0,null==dextResizeIconInterval&&(dextResizeIconInterval=setInterval(function(){G_REMOVE_dextResizeIcon&&G_dextResizeIcon&&(G_dextResizeIcon.parentNode&&(G_dextResizeIcon.parentNode.removeChild(G_dextResizeIcon),clearIfameOverDiv()),G_dextResize_OverElem=G_dextResizeIcon=null,clearInterval(dextResizeIconInterval),dextResizeIconInterval=null)},1500)),DEXTTOP.DEXT5.util.removeEvent(G_dextResize_OverElem,"mouseout",
ResizeElmOutEvt)}catch(b){}};
DextDragResize.prototype.removeDextResizeDiv=function(){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{G_dextResizeDiv&&(G_dextResizeDiv.parentNode&&(DEXTTOP.DEXT5.util.removeEvent(G_dextResizeDiv,"keydown",keyDown),DEXTTOP.DEXT5.util.removeEvent(G_dextResizeDiv,"mousedown",startDragElem),G_dextResizeDiv.parentNode.removeChild(G_dextResizeDiv)),G_dextResizeEditIcon=G_dextResizeDiv=null),G_dextResizeHandleHolder&&(G_dextResizeHandleHolder.parentNode&&(DEXTTOP.DEXT5.util.removeEvent(G_dextResizeHandleHolder,"mousedown",
startDragElem),G_dextResizeHandleHolder.parentNode.removeChild(G_dextResizeHandleHolder)),G_dextResizeHandleHolder=null)}catch(a){}};
DextDragResize.prototype.startDragElem=function(a,b){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{var c=a.target||a.srcElement,d=new RegExp(resizeName+"-([trmbl]{2})","");if(isRightClick(a)){G_dextResize_elem&&(c=G_dextResize_elem);resizeHandleClear();var e=c.tagName.toLowerCase();if("img"==e)selection(c);else if("table"==e){G_dextResize_showContext=!1;var f=getFirstRange();f.sel.removeAllRanges();setTimeout(function(){doSetCaretPosition(getMyFirstChildElementNode(c),0)},1)}return}if(c==G_dextResizeEditIcon){c=
G_dextResize_elem;resizeHandleClear();f=getFirstRange();f.sel.removeAllRanges();"table"==c.tagName.toLowerCase()?(c=getMyFirstChildElementNode(c),doSetCaretPosition(c,0)):"div"==c.tagName.toLowerCase()&&(G_orgEnterTag=DEXTTOP.G_CURREDITOR._config.enterTag,DEXTTOP.G_CURREDITOR._config.enterTag="br",G_dextResizeEditElem=c,doSetCaretPosition(c,0));DEXTTOP.DEXT5.util.cancelEvent(a);return}if(d.test(c.className))elmX=parseInt(G_dextResize_elem.style.left),elmY=parseInt(G_dextResize_elem.style.top),elmW=
G_dextResize_elem.offsetWidth,elmH=G_dextResize_elem.offsetHeight,G_firstDrag=G_isResize=!0,iframeDocLastMouseY=iframeDocLastMouseX=lastMouseY=lastMouseX=0,handle=c;else{G_dextResize_elem&&"TABLE"!=G_dextResize_elem.nodeName&&(G_UseMouseTableInoutdent=!1);if("1"==DEXTTOP.G_CURREDITOR._config.dragResizeMovable||G_UseMouseTableInoutdent||"absolute"==G_dextResize_elem.style.position.toLowerCase())G_isDrag=!0;else if(c.id&&"dextResizeIcon"==c.id){DEXTTOP.DEXT5.util.cancelEvent(a);return}G_firstDrag=!0;
G_lastDragY=G_lastDragX=G_dragY=G_dragX=0}G_REMOVE_dextResizeIcon=!1;clearInterval(dextResizeIconInterval);clearIfameOverDiv();d=_iframeWin;a||(a=d.event);offsetX=a.clientX;offsetY=a.clientY;G_dextResizeDiv.style.left||(G_dextResizeDiv.style.left="0px");G_dextResizeDiv.style.top||(G_dextResizeDiv.style.top="0px");("1"==DEXTTOP.G_CURREDITOR._config.dragResizeMovable||G_UseMouseTableInoutdent||"absolute"==G_dextResize_elem.style.position.toLowerCase()||G_isResize)&&setDextResizeBackDiv();var g=getElementOffset(_iframeWin.frameElement);
"doc"!=b&&(g.left=0,g.top=0);G_startX=G_UseMouseTableInoutdent?""==G_dextResize_elem.style.marginLeft?0:parseInt(G_dextResize_elem.style.marginLeft):parseInt(G_dextResizeDiv.style.left)+G_dextResizeDivBorder-g.left;G_startY=parseInt(G_dextResizeDiv.style.top)+G_dextResizeDivBorder-g.top;set_ruler_vertical_height(DEXTTOP.G_CURREDITOR);DEXTTOP.DEXT5.util.addEvent(G_dextResizeBackDiv,"mousemove",dragElem);DEXTTOP.DEXT5.util.addEvent(document,"mouseup",stopDragElem);onResize({cmd:"start"});DEXTTOP.DEXT5.util.cancelEvent(a)}catch(m){}};
DextDragResize.prototype.dragElem=function(a,b){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{if(G_isResize){elementResize(a,"doc");return}G_REMOVE_dextResizeIcon=!1;if(!G_isDrag)return;var c=_iframeWin;a||(a=c.event);var d=G_startX+a.clientX-offsetX,e=G_startY+a.clientY-offsetY,f=getElementOffset(_iframeWin.frameElement);"doc"==b?(d+=f.left,e+=f.top):G_ie8Bug&&DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&(d-=f.left,e-=f.top);if(G_dextResizeDiv){G_firstDrag?(0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&
DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),G_firstDrag=!1):0==G_UseMouseTableInoutdent&&(G_dextResize_elem.style.position="absolute");if(!(G_UseMouseTableInoutdent&&0>parseInt(G_dextResize_elem.style.marginLeft))){var g=getClientRect(G_dextResize_elem);G_dextResizeDiv.style.left=f.left+g.left-G_dextResizeDivBorder+"px"}G_UseMouseTableInoutdent||(G_dextResizeDiv.style.top=e-G_dextResizeDivBorder+"px");G_dextResizeIcon&&(G_dextResizeIcon.style.left=d+"px",G_dextResizeIcon.style.top=e-13+"px");var m=
getClientRect(_iframeWin.frameElement),h=getWindowScrollPos(_iframeWin);0==G_UseMouseTableInoutdent&&(isNaN(parseInt(G_dextResize_elem.style.left,10))&&(G_dextResize_elem.style.left=d-m.left+h[0]-getClientRect(G_dextResize_elem).left+"px"),isNaN(parseInt(G_dextResize_elem.style.top,10))&&(G_dextResize_elem.style.top=e-m.top+h[1]-getClientRect(G_dextResize_elem).top+"px"));var l=getParentPosition();if(G_UseMouseTableInoutdent){var n=d-m.left-l.left;0>n&&(n=-1);if("1"==DEXTTOP.G_CURREDITOR._config.limitTableInoutdent){var c=
0,p=getClientRect(G_dextResize_elem);if(""!=_iframeDoc.body.style.width&&-1<_iframeDoc.body.style.width.indexOf("px"))c=DEXTTOP.DEXT5.util.parseIntOr0(_iframeDoc.body.style.width);else{c=_iframeDoc.documentElement.clientWidth;if(0==c||null==c||void 0==c)c=_iframeDoc.body.clientWidth;c=Math.floor(c);c-=20}if(0<c){var k=c-(p.right-p.left);0>k&&(k=0);G_dextResize_elem.style.marginLeft=n<=k?n+1+"px":k+"px"}else G_dextResize_elem.style.marginLeft=n+1+"px"}else G_dextResize_elem.style.marginLeft=n+1+"px"}else G_dextResize_elem.style.left=
d-m.left+h[0]-l.left+"px",G_dextResize_elem.style.top=e-m.top+h[1]-l.top+"px";setHandlePosition()}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a)}catch(q){}};
DextDragResize.prototype.getParentPosition=function(){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{for(var a={left:0,top:0},b=G_dextResize_elem;(b=b.parentNode)&&(1!=b.nodeType||"body"!=b.tagName.toLowerCase());)""!=b.style.position&&"static"!=b.style.position&&(a.left+=isNaN(parseInt(b.style.left,10))?0:parseInt(b.style.left,10));for(b=G_dextResize_elem;(b=b.parentNode)&&(1!=b.nodeType||"body"!=b.tagName.toLowerCase());)""!=b.style.position&&"static"!=b.style.position&&(a.top+=isNaN(parseInt(b.style.top,
10))?0:parseInt(b.style.top,10));return a}catch(c){}};
DextDragResize.prototype.stopDragElem=function(a){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{if(G_isDrag||G_isResize)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,G_isResize&&G_dextResize_elem&&"table"==G_dextResize_elem.tagName.toLowerCase()&&setResizeHandle(a,!1);G_firstDrag=G_isDrag=G_ie8Bug=!1;G_dextResizeIcon&&G_dextResizeIcon.parentNode&&(G_dextResizeIcon.parentNode.removeChild(G_dextResizeIcon),G_dextResizeIcon=null);dextResizeIconInterval&&(clearInterval(dextResizeIconInterval),
dextResizeIconInterval=null);G_dextResize_OverElem&&DEXTTOP.DEXT5.util.removeEvent(G_dextResize_OverElem,"mouseout",ResizeElmOutEvt);DEXTTOP.DEXT5.util.removeEvent(document,"mouseup",stopDragElem);removeDextResizeBackDiv();set_ruler_vertical_height(DEXTTOP.G_CURREDITOR)}catch(b){}};
DextDragResize.prototype.setDextResizeBackDiv=function(){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{null==G_dextResizeBackDiv&&(G_dextResizeBackDiv=_iframeDoc.createElement("div"),G_dextResizeBackDiv.style.position="absolute",G_dextResizeBackDiv.style.cursor="move",G_dextResizeBackDiv.style.zIndex=G_dextResizeDiv.style.zIndex+1,G_dextResizeBackDiv.style.width="100%",G_dextResizeBackDiv.style.height="100%",G_dextResizeBackDiv.style.left="0px",G_dextResizeBackDiv.style.top="0px",DEXTTOP.DEXT5.browser.ie&&
9>DEXTTOP.DEXT5.browser.ieVersion?(G_dextResizeBackDiv.style.background="gray",G_dextResizeBackDiv.style.filter="alpha(opacity=5)"):DEXTTOP.DEXT5.browser.ie&&(G_dextResizeBackDiv.style.background="white",G_dextResizeBackDiv.style.opacity="0.1"),getEditorFrameDoc(DEXTTOP.G_CURREDITOR).body.appendChild(G_dextResizeBackDiv))}catch(a){}};
DextDragResize.prototype.elementResize=function(a,b){with(this)try{if(!G_dextResizeDiv)return;mouseX=a.pageX||a.clientX+document.documentElement.scrollLeft;mouseY=a.pageY||a.clientY+document.documentElement.scrollTop;handle&&"top"==b?(topMouseX||(topMouseX=mouseX,topMouseY=mouseY,docMouseY=docMouseX=null),0==docLastMouseX&&(docLastMouseX=lastMouseX),0==docLastMouseY&&(docLastMouseY=lastMouseY),mouseX=docLastMouseX+(mouseX-topMouseX),mouseY=docLastMouseY+(mouseY-topMouseY),iframeDocLastMouseX=mouseX,
iframeDocLastMouseY=mouseY):handle&&"doc"==b&&(docMouseX||(docMouseX=mouseX,docMouseY=mouseY,topMouseY=topMouseX=null),mouseX=iframeDocLastMouseX+(mouseX-docMouseX),mouseY=iframeDocLastMouseY+(mouseY-docMouseY),docLastMouseX=mouseX,docLastMouseY=mouseY);var c=mouseX-lastMouseX+mOffX,d=mouseY-lastMouseY+mOffY;mOffX=mOffY=0;lastMouseX=mouseX;lastMouseY=mouseY;!b&&handle&&(iframeDocLastMouseX=mouseX,iframeDocLastMouseY=mouseY);if(!handle)return!0;G_firstDrag&&(0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&
DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),G_firstDrag=!1);var e=!1;if(this.resizeHandleDrag&&this.resizeHandleDrag(c,d))e=!0;else{var f=c,g=d;elmX+f<minLeft?mOffX=f-(c=minLeft-elmX):elmX+elmW+f>maxLeft&&(mOffX=f-(c=maxLeft-elmX-elmW));elmY+g<minTop?mOffY=g-(d=minTop-elmY):elmY+elmH+g>maxTop&&(mOffY=g-(d=maxTop-elmY-elmH));elmX+=c;elmY+=d}if(e){var m=getElementBorderWidth(),h=DEXTTOP.DEXT5.util.parseIntOr0(m.borderTopWidth)+DEXTTOP.DEXT5.util.parseIntOr0(m.borderBottomWidth),l=DEXTTOP.DEXT5.util.parseIntOr0(G_dextResize_elem.style.paddingTop)+
DEXTTOP.DEXT5.util.parseIntOr0(G_dextResize_elem.style.paddingBottom),n=G_dextResize_elem.style.width,p=G_dextResize_elem.style.height,k,e=0;if(-1<n.indexOf("%")||-1<p.indexOf("%")){var q=getClientRect(G_dextResize_elem);k=DEXTTOP.DEXT5.util.parseIntOr0(q.right-q.left);e=DEXTTOP.DEXT5.util.parseIntOr0(q.bottom-q.top)}else if(k=DEXTTOP.DEXT5.util.parseIntOr0(n,10),e=DEXTTOP.DEXT5.util.parseIntOr0(p,10),0==k||0==e)q=getClientRect(G_dextResize_elem),0==k&&(k=DEXTTOP.DEXT5.util.parseIntOr0(q.right-q.left)),
0==e&&(e=DEXTTOP.DEXT5.util.parseIntOr0(q.bottom-q.top));var r=handle&&handle.className&&handle.className.match(new RegExp(resizeName+"-([tmblr]{2})"))?RegExp.$1:"";if("IMG"==G_dextResize_elem.tagName&&(-1<r.indexOf("br")||-1<r.indexOf("bl")||-1<r.indexOf("tl")||-1<r.indexOf("tr")))k=parseInt(elmW,10)-(h+l),setNodeWidthHeight(G_dextResize_elem,{width:k+"px",height:DEXTTOP.DEXT5.util.parseIntOr0(1*k/G_ImageR)+"px"});else{if(0<=r.indexOf("l")||0<=r.indexOf("r"))k=parseInt(elmW,10)-(h+l),setNodeWidthHeight(G_dextResize_elem,
{width:k+"px"}),""!=G_dextResize_elem.style.height||!G_dextResize_elem.getAttribute("height")&&""!=G_dextResize_elem.getAttribute("height")||setNodeWidthHeight(G_dextResize_elem,{height:e+"px"});if(0<=r.indexOf("t")||0<=r.indexOf("b"))e=parseInt(elmH,10)-(h+l),setNodeWidthHeight(G_dextResize_elem,{height:e+"px"}),""!=G_dextResize_elem.style.width||!G_dextResize_elem.getAttribute("width")&&""!=G_dextResize_elem.getAttribute("width")||setNodeWidthHeight(G_dextResize_elem,{width:k+"px"})}"1"==DEXTTOP.G_CURREDITOR._config.dragResizeMovable&&
(G_dextResize_elem.style.left=parseInt(elmX,10)+"px",G_dextResize_elem.style.top=parseInt(elmY,10)+"px");if("table"==G_dextResize_elem.tagName.toLowerCase()){for(var h=G_dextResize_elem,z=DEXTTOP.DEXT5.util.parseIntOr0(G_dextResize_elem.style.width,10),A=DEXTTOP.DEXT5.util.parseIntOr0(G_dextResize_elem.style.height,10),l=0,w=h.rows.length,n=0;n<w;n++)var u=h.rows[n],l=l+parseFloat(u.cells[0].style.height.replace("px",""));for(n=0;n<w;n++){for(var u=h.rows[n],v=u.cells.length,p=k=0;p<v;p++){var t=
u.cells[p];k+=parseFloat(t.style.width.replace("px",""))}if((0<=r.indexOf("l")||0<=r.indexOf("r"))&&z!=k)for(k=(k-z)/v,p=0;p<v;p++){var t=u.cells[p],E=Math.floor(100*parseFloat(parseFloat(t.style.width.replace("px",""))-k+parseFloat(c/v)))/100;t.style.width=E+"px"}if((0<=r.indexOf("t")||0<=r.indexOf("b"))&&A!=l)for(k=(l-A)/w,p=0;p<v;p++){var t=u.cells[p],F=Math.floor(100*parseFloat(parseFloat(t.style.height.replace("px",""))-k+parseFloat(d/w)))/100;t.style.height=F+"px"}}}setHandlePosition();G_dextResizeHandleHolder.dext_resizeinfo.style.display=
"";G_dextResizeHandleHolder.dext_resizeinfo.style.zIndex=1E6;G_dextResizeHandleHolder.dext_resizeinfo.style.top=handle.offsetTop+"px";G_dextResizeHandleHolder.dext_resizeinfo.style.left=handle.offsetLeft+"px";G_dextResizeHandleHolder.dext_resizeinfo.firstChild&&G_dextResizeHandleHolder.dext_resizeinfo.removeChild(G_dextResizeHandleHolder.dext_resizeinfo.firstChild);var B=document.createElement("span"),G=DEXTTOP.DEXT5.util.parseIntOr0(getNodeWidthHeight(G_dextResize_elem,"width"),10),y=DEXTTOP.DEXT5.util.parseIntOr0(getNodeWidthHeight(G_dextResize_elem,
"height"),10);if(0==y)var C=getClientRect(G_dextResize_elem),y=DEXTTOP.DEXT5.util.parseIntOr0(C.bottom-C.top);B.innerHTML=G+" X "+y;G_dextResizeHandleHolder.dext_resizeinfo.appendChild(B)}if(G_dextResizeDiv){var x=getElementOffset(_iframeWin.frameElement),D=getWindowScrollPos(_iframeWin),d=c=0;DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion?(c=getElementOffset(G_dextResize_elem).left+x.left-G_dextResizeDivBorder,d=getElementOffset(G_dextResize_elem).top+x.top-G_dextResizeDivBorder):(c=
getElementOffset(G_dextResize_elem).left+x.left-G_dextResizeDivBorder-D[0],d=getElementOffset(G_dextResize_elem).top+x.top-G_dextResizeDivBorder-D[1]);if("1"==DEXTTOP.G_CURREDITOR._config.dragResizeMovable||G_UseMouseTableInoutdent)G_dextResizeDiv.style.left=c+"px";G_dextResizeDiv.style.top=d+"px";isNaN(elmW)||(G_dextResizeDiv.style.width=parseInt(elmW,10)+"px");isNaN(elmH)||(G_dextResizeDiv.style.height=parseInt(elmH,10)+"px")}DEXTTOP.DEXT5.util.cancelEvent(a)}catch(H){}};
DextDragResize.prototype.getElementBorderWidth=function(){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{var a={borderTopWidth:G_dextResize_elem.style.borderTopWidth,borderBottomWidth:G_dextResize_elem.style.borderBottomWidth};"thick"==a.borderTopWidth?a.borderTopWidth=5:"medium"==a.borderTopWidth?a.borderTopWidth=3:"thin"==a.borderTopWidth&&(a.borderTopWidth=1);"thick"==a.borderBottomWidth?a.borderBottomWidth=5:"medium"==a.borderBottomWidth?a.borderBottomWidth=3:"thin"==a.borderBottomWidth&&(a.borderBottomWidth=
1);return a}catch(b){}};
DextDragResize.prototype.resizeHandleDrag=function(a,b){with(this)try{var c=handle&&handle.className&&handle.className.match(new RegExp(resizeName+"-([tmblr]{2})"))?RegExp.$1:"",d=b,e=a,f=!1;0<=c.indexOf("t")&&(rs=1,elmH-d<minHeight?mOffY=d-(b=elmH-minHeight):elmY+d<minTop&&(mOffY=d-(b=minTop-elmY)),elmY+=b,elmH-=b,f=!0);0<=c.indexOf("b")&&(rs=1,elmH+d<minHeight?mOffY=d-(b=minHeight-elmH):elmY+elmH+d>maxTop&&(mOffY=d-(b=maxTop-elmY-elmH)),elmH+=b,f=!0);0<=c.indexOf("l")&&(rs=1,elmW-e<minWidth?mOffX=
e-(a=elmW-minWidth):elmX+e<minLeft&&(mOffX=e-(a=minLeft-elmX)),elmX+=a,elmW-=a,f=!0);0<=c.indexOf("r")&&(rs=1,elmW+e<minWidth?mOffX=e-(a=minWidth-elmW):elmX+elmW+e>maxLeft&&(mOffX=e-(a=maxLeft-elmX-elmW)),elmW+=a,f=!0);return f}catch(g){}};
DextDragResize.prototype.mouseUp=function(a){with(this)try{if(isRightClick(a))return;var b=!0;try{if(0==G_isResize){var c=a.target?a.target:a.srcElement;if(c){var d=null,e=null;9!=c.nodeType&&(d=c.ownerDocument);(e=getDocWindow(d).frameElement)?0!=e.id.indexOf("dext_frame_")&&0!=e.id.indexOf("dext5_design_")&&(b=!1):b=!1}}}catch(f){}if(0==b){resizeHandleClear();return}if(G_dextResize_elem&&"img"==G_dextResize_elem.tagName.toLowerCase()&&"absolute"!=G_dextResize_elem.style.position){var g,m;if(-1<
G_dextResize_elem.style.width.indexOf("%")||-1<G_dextResize_elem.style.height.indexOf("%")){var h=getClientRect(G_dextResize_elem);g=h.right-h.left;m=h.bottom-h.top}else""!=G_dextResize_elem.style.width?g=DEXTTOP.DEXT5.util.parseIntOr0(G_dextResize_elem.style.width):(h=getClientRect(G_dextResize_elem),g=h.right-h.left),""!=G_dextResize_elem.style.height?m=DEXTTOP.DEXT5.util.parseIntOr0(G_dextResize_elem.style.height):(h=getClientRect(G_dextResize_elem),m=h.bottom-h.top);G_ImageR=1*g/m;var l=G_dextResize_elem.parentNode;
if(!DEXTTOP.DEXT5.browser.chrome&&!DEXTTOP.DEXT5.browser.opera){if(G_dextResize_elem.parentNode.tagName&&"figure"==G_dextResize_elem.parentNode.tagName.toLowerCase()){var n=G_dextResize_elem.parentNode.getElementsByTagName("figcaption");n&&n[0]&&(l=getMyFirstChildElementNode(n[0]),rangy.getSelection(_iframeWin).removeAllRanges(),doSetCaretPosition(l,0))}DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&doSetCaretPosition(l,0)}}G_dextResize_elem.getAttribute("raon_chart")&&G_dextResize_elem.setAttribute("raon_plugin",
"chart");onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0});stopDragElem();onResize({cmd:"end",event:a,target:G_dextResize_elem,isResize:G_isResize});deselect(!1);G_isResize=!1;if("1"==DEXTTOP.G_CURREDITOR._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.mouse?DEXTTOP.G_CURREDITOR._config.event.mouse("mouseup",a,G_dextResize_elem):DEXTTOP.DEXTWIN.dext_mouse_event("mouseup",a,G_dextResize_elem)}catch(p){}if(1==
DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}docMouseY=docMouseX=topMouseY=topMouseX=null}catch(k){}};DextDragResize.prototype.deselect=function(a){with(this)try{G_dextResizeHandleHolder&&(G_dextResizeHandleHolder.dext_resizeinfo.style.display="none",G_dextResizeHandleHolder.dext_resizeinfo.innerHTML=""),handle=null,mOffY=mOffX=0}catch(b){}};
DextDragResize.prototype.resizeHandleClear=function(){with(this)try{stopDragElem(),clearIfameOverDiv(),removeDextResizeDiv(),G_mouseOveriframeObj=G_dextResize_elem=G_dextResizeIcon=G_dextResize_OverElem=null}catch(a){}};
DextDragResize.prototype.clearIfameOverDiv=function(){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{G_dextIframeOverDiv&&G_dextIframeOverDiv.parentNode&&(DEXTTOP.DEXT5.util.removeEvent(G_dextIframeOverDiv,"mousedown",ifameOverDivClick),G_dextIframeOverDiv.parentNode.removeChild(G_dextIframeOverDiv)),G_dextIframeOverDiv=null}catch(a){}};
DextDragResize.prototype.removeDextResizeBackDiv=function(){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{G_dextResizeBackDiv&&(G_dextResizeBackDiv.parentNode&&(DEXTTOP.DEXT5.util.removeEvent(G_dextResizeBackDiv,"mousemove",dragElem),G_dextResizeBackDiv.parentNode.removeChild(G_dextResizeBackDiv)),G_dextResizeBackDiv=null)}catch(a){}};
DextDragResize.prototype.keyDown=function(a){with(DEXTTOP.G_CURREDITOR.dext_dragresize)try{if(!G_dextResize_elem)return;var b=G_dextResize_elem,c=a.ctrlKey,d="which"in a?a.which:a.keyCode;if(G_dextResizeDiv)if(37<=d&&40>=d)if("1"==DEXTTOP.G_CURREDITOR._config.dragResizeMovable||G_UseMouseTableInoutdent){"1"==DEXTTOP.G_CURREDITOR._config.dragResizeMovable&&(G_dextResize_elem.style.position="absolute");switch(d){case 37:G_UseMouseTableInoutdent?G_dextResize_elem.style.marginLeft=parseIntOr0(G_dextResize_elem.style.marginLeft,
10)-1+"px":G_dextResize_elem.style.left=parseIntOr0(G_dextResize_elem.style.left,10)-1+"px";G_dextResizeDiv.style.left=parseIntOr0(G_dextResizeDiv.style.left,10)-1+"px";break;case 38:"1"==DEXTTOP.G_CURREDITOR._config.dragResizeMovable&&(G_dextResize_elem.style.top=parseIntOr0(G_dextResize_elem.style.top,10)-1+"px",G_dextResizeDiv.style.top=parseIntOr0(G_dextResizeDiv.style.top,10)-1+"px");break;case 39:G_UseMouseTableInoutdent?G_dextResize_elem.style.marginLeft=parseIntOr0(G_dextResize_elem.style.marginLeft,
10)+1+"px":G_dextResize_elem.style.left=parseIntOr0(G_dextResize_elem.style.left,10)+1+"px";G_dextResizeDiv.style.left=parseIntOr0(G_dextResizeDiv.style.left,10)+1+"px";break;case 40:"1"==DEXTTOP.G_CURREDITOR._config.dragResizeMovable&&(G_dextResize_elem.style.top=parseIntOr0(G_dextResize_elem.style.top,10)+1+"px",G_dextResizeDiv.style.top=parseIntOr0(G_dextResizeDiv.style.top,10)+1+"px")}setHandlePosition();DEXTTOP.DEXT5.util.cancelEvent(a)}else resizeHandleClear();else if(c&&(86==d||65==d||88==
d||67==d)||46==d||8==d)if(resizeHandleClear(),"table"!=b.tagName.toLowerCase()||46!=d&&8!=d){if("img"==b.tagName.toLowerCase()){var e=GetParentbyTagName(b,"figure");if(e&&(b=e,46==d||8==d)){b.parentNode.removeChild(b);DEXTTOP.DEXT5.util.cancelEvent(a);return}}selection(b)}else b.parentNode.removeChild(b);else(c&&90==d||89==d||!c)&&resizeHandleClear()}catch(f){}};
